# 接口文档（磁贴生活记录系统）

---

## 1. 用户注册

### 基本信息
- 请求路径：`/register`
- 请求方式：POST
- 接口描述：新用户注册账号，成功后自动登录并下发 JWT。

### 请求参数
- 参数格式：`application/json`

| 名称     | 类型   | 是否必须 | 备注         |
| -------- | ------ | -------- | ------------ |
| username | string | 必须     | 用户名，唯一 |
| password | string | 必须     | 密码         |
| nickname | string | 可选     | 昵称         |
| avatar   | string | 可选     | 头像 URL     |

- 请求数据样例
```json
{
  "username": "alice",
  "password": "123456",
  "nickname": "Alice",
  "avatar": "https://example.com/avatar.png"
}
```

### 响应数据
- 参数格式：`application/json`

| 名称 | 类型       | 是否必须 | 备注                    |
| ---- | ---------- | -------- | ----------------------- |
| code | number     | 必须     | 响应码, 1 成功 ; 0 失败 |
| msg  | string     | 必须     | 提示信息                |
| data | object     | 必须     | 返回的数据              |
| \\   | - id       | number   | 必须                    |
| \\   | - username | string   | 必须                    |
| \\   | - nickname | string   | 必须                    |
| \\   | - avatar   | string   | 必须                    |
| \\   | - token    | string   | 必须                    |

---

## 2. 用户登录

### 基本信息
- 请求路径：`/login`
- 请求方式：POST
- 接口描述：用户登录，成功后返回 JWT。

### 请求参数
- 参数格式：`application/json`

| 名称     | 类型   | 是否必须 | 备注   |
| -------- | ------ | -------- | ------ |
| username | string | 必须     | 用户名 |
| password | string | 必须     | 密码   |

- 请求数据样例
```json
{
  "username": "alice",
  "password": "123456"
}
```

### 响应数据
同注册接口。

---

## 3. 获取每日一句

### 请求参数（Header）

- Authorization: Bearer {token}

### 基本信息
- 请求路径：`/saying`
- 请求方式：GET
- 接口描述：从 sayings 表随机返回一条正能量语句。

### 请求参数
- 无

### 响应数据
- 参数格式：`application/json`

| 名称 | 类型   | 是否必须 | 备注     |
| ---- | ------ | -------- | -------- |
| code | number | 必须     | 响应码   |
| msg  | string | 必须     | 提示信息 |
| data | object | 必须     | 返回数据 |
| \\   | - text | string   | 必须     |

---

## 4. 获取当前用户信息

### 基本信息
- 请求路径：`/user/profile`
- 请求方式：GET
- 接口描述：获取登录用户的头像与昵称。

### 请求参数（Header）
- Authorization: Bearer {token}

### 响应数据
- 参数格式：`application/json`

| 名称 | 类型       | 是否必须 | 备注   |
| ---- | ---------- | -------- | ------ |
| code | number     | 必须     | 响应码 |
| msg  | string     | 必须     | 提示   |
| data | object     | 必须     | 数据   |
| \\   | - nickname | string   | 必须   |
| \\   | - avatar   | string   | 必须   |

---

## 5. 获取磁贴列表

### 基本信息
- 请求路径：`/tiles`

- 请求方式：GET

- 接口描述：按时间倒序返回当前用户的磁贴；支持按日期区间筛选。

### 请求参数（Header）

- Authorization: Bearer {token}

### 请求参数（Query）

| 参数名称   | 是否必须 | 示例     | 备注                                       |
| ---------- | -------- | -------- | ------------------------------------------ |
| content    | 否       | 啊啊啊   | 模糊查找的内容                             |
| start_date | 否       | 2010/1/1 | 开始日期 (YYYY-MM-DD)                      |
| end_date   | 否       | 2020/1/1 | 结束日期 (YYYY-MM-DD)                      |
| page       | 否       | 1        | 分页查询的页码，如果未指定，默认为1        |
| pageSize   | 否       | 10       | 分页查询的每页记录数，如果未指定，默认为10 |

### 响应数据

- 参数格式：`application/json`

| 名称 | 类型        | 是否必须 | 备注               |
| ---- | ----------- | -------- | ------------------ |
| code | number      | 必须     | 响应码             |
| msg  | string      | 必须     | 提示               |
| data | object      | 必须     |                    |
| \    | - total     | number   | 查找到的磁贴总数量 |
| \    | - rows      | array    | 磁贴数组           |
| \\   | -- id       | number   | 必须               |
| \\   | -- content  | string   | 必须               |
| \\   | -- createAt | string   | 必须               |
| \\   | -- updateAt | string   | 必须               |



---

## 6. 新增磁贴

### 基本信息
- 请求路径：`/tiles`
- 请求方式：POST
- 接口描述：创建一条新的磁贴，默认使用当前服务器时间。

### 请求参数（Header）

- Authorization: Bearer {token}

### 请求参数
- 参数格式：`application/json`

| 名称    | 类型   | 是否必须 | 备注 |
| ------- | ------ | -------- | ---- |
| content | string | 必须     | 内容 |

- 请求数据样例
```json
{
  "content": "今天完成了晨跑，感觉真棒！"
}
```

### 响应数据
- 参数格式：`application/json`

| 名称 | 类型         | 是否必须 | 备注   |
| ---- | ------------ | -------- | ------ |
| code | number       | 必须     | 响应码 |
| msg  | string       | 必须     | 提示   |
| data | object       | 必须     | 新磁贴 |
| \\   | - id         | number   | 必须   |
| \    | - content    | string   | 必须   |
| \\   | - created_at | string   | 必须   |
| \    | - updatedAt  | string   | 必须   |

---

## 7. 编辑磁贴

### 基本信息
- 请求路径：`/tiles/{tileId}`
- 请求方式：PUT
- 接口描述：根据磁贴 ID 更新内容。

### 请求参数（Header）

- Authorization: Bearer {token}

### 请求参数
- 参数格式：`application/json`

| 名称    | 类型   | 是否必须 | 备注   |
| ------- | ------ | -------- | ------ |
| content | string | 必须     | 新内容 |

- 请求数据样例
```json
{
  "content": "今天完成了 5 公里晨跑，非常充实！"
}
```

### 响应数据
- 参数格式：`application/json`

| 名称 | 类型         | 是否必须 | 备注         |
| ---- | ------------ | -------- | ------------ |
| code | number       | 必须     | 响应码       |
| msg  | string       | 非必须   | 提示         |
| data | object       | 必须     | 更新后的磁贴 |
| \\   | - id         | number   | 必须         |
| \    | - content    | string   | 必须         |
| \\   | - created_at | string   | 必须         |
| \    | - updatedAt  | string   | 必须         |

---

## 8. 获取人物列表（含磁贴）

### 基本信息
- 请求路径：`/persons`
- 请求方式：GET
- 接口描述：返回系统已归纳的人物及其对应磁贴。

### 请求参数（Header）

- Authorization: Bearer {token}

### 请求参数
- 无

### 响应数据
- 参数格式：`application/json`

| 名称 | 类型    | 是否必须     | 备注     |
| ---- | ------- | ------------ | -------- |
| code | number  | 必须         | 响应码   |
| msg  | string  | 非必须       | 提示     |
| data | array   | 必须         | 人物列表 |
| \\   | - id    | number       | 必须     |
| \\   | - name  | string       | 必须     |
| \\   | - tiles | array        | 必须     |
| \\   | \\      | - id         | number   |
| \\   | \\      | - content    | string   |
| \\   | \\      | - created_at | string   |

---

## 9. 修改人物名称

### 基本信息
- 请求路径：`/persons/{personId}`
- 请求方式：PUT
- 接口描述：修改指定人物的名称。

### 请求参数（Header）

- Authorization: Bearer {token}

### 请求参数
- 参数格式：`application/json`

| 名称 | 类型   | 是否必须 | 备注   |
| ---- | ------ | -------- | ------ |
| name | string | 必须     | 新名称 |

- 请求数据样例
```json
{
  "name": "运动伙伴"
}
```

### 响应数据
- 参数格式：`application/json`

| 名称 | 类型   | 是否必须 | 备注       |
| ---- | ------ | -------- | ---------- |
| code | number | 必须     | 响应码     |
| msg  | string | 非必须   | 提示       |
| data | object | 必须     | 更新后人物 |
| \\   | - id   | number   | 必须       |
| \\   | - name | string   | 必须       |

---

## 10. AI 分析人物事件

### 基本信息
- 请求路径：`/persons/{personId}/analyze`
- 请求方式：POST
- 接口描述：请求 AI 对该人物相关磁贴内容做归纳分析，返回一段总结。

### 请求参数（Header）

- Authorization: Bearer {token}

### 请求参数
- 无

### 响应数据
- 参数格式：`application/json`

| 名称 | 类型      | 是否必须 | 备注     |
| ---- | --------- | -------- | -------- |
| code | number    | 必须     | 响应码   |
| msg  | string    | 非必须   | 提示     |
| data | object    | 必须     | 分析结果 |
| \\   | - summary | string   | 必须     |

---

## 11. 修改密码

### 基本信息
- 请求路径：`/user/password`
- 请求方式：PUT
- 接口描述：修改当前登录用户密码。

### 请求参数（Header）

- Authorization: Bearer {token}

### 请求参数
- 参数格式：`application/json`

| 名称        | 类型   | 是否必须 | 备注   |
| ----------- | ------ | -------- | ------ |
| oldPassword | string | 必须     | 旧密码 |
| newPassword | string | 必须     | 新密码 |

- 请求数据样例
```json
{
  "oldPassword": "123456",
  "newPassword": "abcdef"
}
```

### 响应数据
- 参数格式：`application/json`

| 名称 | 类型   | 是否必须 | 备注   |
| ---- | ------ | -------- | ------ |
| code | number | 必须     | 响应码 |
| msg  | string | 非必须   | 提示   |

---

## 12. AI 聊天

### 基本信息
- 请求路径：`/ai/chat`
- 请求方式：POST
- 接口描述：通用 AI 对话，用户输入问题，AI 返回答案。

### 请求参数（Header）

- Authorization: Bearer {token}

### 请求参数
- 参数格式：`application/json`

| 名称    | 类型   | 是否必须 | 备注 |
| ------- | ------ | -------- | ---- |
| content | string | 必须     | 问题 |

- 请求数据样例
```json
{
  "content": "如何提高写作效率？"
}
```

### 响应数据
- 参数格式：`application/json`

| 名称 | 类型    | 是否必须 | 备注     |
| ---- | ------- | -------- | -------- |
| code | number  | 必须     | 响应码   |
| msg  | string  | 非必须   | 提示     |
| data | object  | 必须     | 回答数据 |
| \\   | - reply | string   | 必须     |

# 13.获取当前用户周围的用户
## 基本信息
- 请求路径：`/users/around`
- 请求方式：GET
- 接口描述：获取当前用户周围用户。 
## 请求头（Header）
- Authorization: Bearer {token}
## 请求参数
- 参数格式: `application/json`

| 名称 | 类型 | 是否必须 | 备注 |
| --- | --- | --- | --- |
| latitude | number | 必须 | 纬度 |
| longitude | number | 必须 | 经度 |
## 响应数据
- 参数格式: `application/json`
- 响应数据样例

哈哈哈，这个项目真是个好架子，完全可以用实时语音功能
